(this.webpackJsonpboardgames=this.webpackJsonpboardgames||[]).push([[4,7,10],{589:function(e,r,n){"use strict";n.d(r,"a",(function(){return a}));var t=n(52),c=n(1),a={STRIP_SECRETS:function(e,r,n){var a=Object(c.a)({},e);return void 0!==a.secret&&delete a.secret,a.players&&(a.players=Object(t.a)({},n,a.players[n])),a}}},593:function(e,r,n){"use strict";n.r(r),n.d(r,"isBet",(function(){return O})),n.d(r,"toOrdinal",(function(){return h})),n.d(r,"scoreSuit",(function(){return v})),n.d(r,"canPlayCardToBoard",(function(){return x})),n.d(r,"canPlayCardToDiscard",(function(){return k})),n.d(r,"canDrawCardFromDeck",(function(){return y})),n.d(r,"canDrawCardFromDiscard",(function(){return C}));var t=n(52),c=n(12),a=n(1),i=n(3),s=n(589),d=n(200),u=["yellow","blue","white","green","red"],l=[-1,-2,-3],o=[2,3,4,5,6,7,8,9,10],j="0",b="1";function O(e){return l.includes(e.rank)}function h(e){return 100*(u.indexOf(e.suit)+1)+e.rank}function f(e){for(var r=0,n=[j,b];r<n.length;r++){var t=n[r],c=Object.values(Object.values(e.played[t])),a=Object(d.h)(c.map((function(e){return v(e)})));e.scores[t].push(a)}var i=Object(d.h)(e.scores[0]),s=Object(d.h)(e.scores[1]);e.turnOrder=i>s?[j,b]:s>i?[b,j]:[e.turnOrder[1],e.turnOrder[0]]}function p(e,r){return Object(a.a)(Object(a.a)({},e),function(e){for(var r,n,a=e.random.Shuffle(u.flatMap((function(e){return[].concat(Object(c.a)(o.map((function(r){return{suit:e,rank:r}}))),Object(c.a)(l.map((function(r){return{suit:e,rank:r}}))))}))),i=[],s=[],d=0;d<8;d++)i.push(a.pop()),s.push(a.pop());var O=function(){return Object.fromEntries(u.map((function(e){return[e,[]]})))};return{secret:{deck:a},players:(r={},Object(t.a)(r,j,{hand:i}),Object(t.a)(r,b,{hand:s}),r),played:(n={},Object(t.a)(n,j,O()),Object(t.a)(n,b,O()),n),discarded:O(),deckSize:a.length}}(r))}function v(e){if(0===e.length)return 0;var r=Object(d.e)(e,(function(e){return O(e)})),n=r.true,t=r.false,c=n.length;return(Object(d.h)(t.map((function(e){return e.rank})))-20)*(c+1)+(e.length>=8?20:0)}function m(e,r,n){return e.players[r.currentPlayer].hand.findIndex((function(e){var r=e.rank,t=e.suit;return r===n.rank&&t===n.suit}))}function x(e,r,n){if(-1===m(e,r,n))return"card_not_in_player_hand";var t=Object(d.c)(e.played[r.currentPlayer][n.suit]);return null!=t&&!O(t)&&n.rank<t.rank?"card_out_of_order":void 0}function k(e,r,n){if(-1===m(e,r,n))return"card_not_in_player_hand"}function y(e,r){if(0===e.deckSize)return"deck_empty"}function C(e,r,n){if(!u.includes(n))return"unknown_discard_pile";var t=Object(d.c)(e.discarded[n]);return null==t?"cannot_draw_from_empty_discard_pile":t.turn===r.turn?"cannot_draw_just_discarded_card":void 0}var g={name:"soaring-cities",minPlayers:2,maxPlayers:2,setup:function(){var e;return{scores:(e={},Object(t.a)(e,j,[]),Object(t.a)(e,b,[]),e),turnOrder:[j,b]}},moves:{playCardToBoard:{move:function(e,r,n){if(null!=x(e,r,n))return i.t;var t=m(e,r,n);e.players[r.currentPlayer].hand.splice(t,1),e.played[r.currentPlayer][n.suit].push(Object(a.a)(Object(a.a)({},n),{},{turn:r.turn})),r.events.setStage("drawCard")},client:!1},playCardToDiscard:{move:function(e,r,n){if(null!=k(e,r,n))return i.t;var t=m(e,r,n);e.players[r.currentPlayer].hand.splice(t,1),e.discarded[n.suit].push(Object(a.a)(Object(a.a)({},n),{},{turn:r.turn})),r.events.setStage("drawCard")},client:!1}},turn:{onBegin:function(e){return Object(a.a)(Object(a.a)({},e),{},{deckSize:e.secret.deck.length})},order:i.k.CUSTOM_FROM("turnOrder"),stages:{drawCard:{moves:{drawCardFromDeck:{move:function(e,r){if(null!=y(e))return i.t;var n=e.secret.deck.pop();e.players[r.currentPlayer].hand.push(n),r.events.endTurn(),0===e.secret.deck.length&&r.events.endPhase()},client:!1},drawCardFromDiscard:{move:function(e,r,n){if(null!=C(e,r,n))return i.t;var t=e.discarded[n].pop();e.players[r.currentPlayer].hand.push(t),r.events.endTurn()},client:!1}}}}},phases:Object.fromEntries(Object(d.f)(3).map((function(e){return["Round ".concat(e+1),{start:0===e,next:2===e?void 0:"Round ".concat(e+2),onBegin:p,onEnd:f}]}))),endIf:function(e,r){if(null==r.phase){var n=Object(d.h)(e.scores[0]),t=Object(d.h)(e.scores[1]);return{winner:n>t?j:t>n?b:"tied"}}},playerView:s.a.STRIP_SECRETS,events:{endStage:!1,endTurn:!1,endPhase:!1,endGame:!1,setStage:!1,setPhase:!1,setActivePlayers:!1},disableUndo:!0};r.default=g},594:function(e,r,n){},601:function(e,r,n){"use strict";n.r(r),n.d(r,"default",(function(){return x}));var t=n(1),c=n(21),a=n(6),i=n(0),s=n(201),d=n.n(s),u=n(58),l=n(593),o=n(200);n(594);function j(e){var r=e.deckSize,n=e.round;return Object(a.jsxs)("div",{className:"deck",children:[n,", cards remaining: ",r]})}function b(e){var r=e.points,n=r<0?Object(a.jsx)(a.Fragment,{children:"\u2212"}):void 0,t=Math.abs(r);return Object(a.jsxs)("span",{className:"points",children:[n,"$",t,"M"]})}function O(e){var r=e.cards,n=e.scores,i=e.caption;return Object(a.jsxs)("div",{className:"played",children:[Object(a.jsxs)("label",{children:[i,", ",Object(a.jsx)(b,{points:Object(o.h)(n)})]}),Object(a.jsx)("ul",{children:Object.entries(r).map((function(e){var r=Object(c.a)(e,2),n=r[0],i=r[1];return Object(a.jsx)("li",{className:d()("suit",n,"cards-".concat(i.length)),children:Object(a.jsx)("ol",{children:i.map((function(e){return Object(a.jsx)("li",{children:Object(a.jsx)(f,Object(t.a)({},e))},Object(l.toOrdinal)(e))}))})},n)}))})]})}function h(e){var r=e.G,n=e.ctx,s=e.onPickSuit,u=e.pickedSuit,o=e.disabled,j=Object(i.useCallback)((function(e){var r=e.target.value;s(r)}),[s]);return Object(a.jsxs)("div",{className:"discarded",children:[Object(a.jsx)("label",{children:"Discarded cards"}),Object(a.jsx)("ul",{children:Object.entries(r.discarded).map((function(e){var i=Object(c.a)(e,2),s=i[0],b=i[1],O="pickedSuit-".concat(s),h=s===u;return Object(a.jsxs)("li",{className:d()("suit",s,"cards-".concat(b.length),{checked:h}),children:[Object(a.jsx)("ol",{children:b.map((function(e){return Object(a.jsx)("li",{children:Object(a.jsx)(f,Object(t.a)({},e))},Object(l.toOrdinal)(e))}))}),Object(a.jsx)("input",{type:"radio",name:"pickedSuit",value:s,onChange:j,checked:h,disabled:o||null!=Object(l.canDrawCardFromDiscard)(r,n,s),id:O}),Object(a.jsxs)("label",{htmlFor:O,children:["Pick ",s]})]},s)}))})]})}function f(e){return Object(a.jsx)("span",{className:d()("card",e.suit),children:Object(l.isBet)(e)?"bet":e.rank})}function p(e){var r=e.cards,n=e.onPickCard,c=e.pickedCard,s=e.disabled,u=Object(i.useCallback)((function(e){var r=JSON.parse(e.target.value);n(r)}),[n]);return Object(a.jsxs)("div",{className:"hand",children:[Object(a.jsx)("label",{children:"Your hand"}),Object(a.jsx)("ul",{children:r.sort((function(e,r){return Object(l.toOrdinal)(e)-Object(l.toOrdinal)(r)})).map((function(e){var r="pickedCard-".concat(Object(l.toOrdinal)(e)),n=e.suit===(null===c||void 0===c?void 0:c.suit)&&e.rank===(null===c||void 0===c?void 0:c.rank);return Object(a.jsxs)("li",{className:d()({checked:n}),children:[Object(a.jsx)("input",{type:"radio",name:"pickedCard",value:JSON.stringify(e),onChange:u,checked:n,disabled:s,id:r}),Object(a.jsx)("label",{htmlFor:r,children:Object(a.jsx)(f,Object(t.a)({},e))})]},r)}))})]})}function v(e){var r,n=e.G,t=e.ctx,c=e.card,i=e.suit,s=e.moves,d=e.active,u=e.stage;return d&&"playCard"===u?r=Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("button",{onClick:function(){return s.playCardToBoard(c)},disabled:null==c||null!=Object(l.canPlayCardToBoard)(n,t,c),children:"Play card"}),Object(a.jsx)("button",{onClick:function(){return s.playCardToDiscard(c)},disabled:null==c||null!=Object(l.canPlayCardToDiscard)(n,t,c),children:"Discard card"})]}):d&&"drawCard"===u?r=Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("button",{onClick:function(){return s.drawCardFromDeck()},disabled:null!=Object(l.canDrawCardFromDeck)(n,t),children:"Draw card"}),Object(a.jsxs)("button",{onClick:function(){return s.drawCardFromDiscard(i)},disabled:null==i||null!=Object(l.canDrawCardFromDiscard)(n,t,i),children:["Pick ",i||"discarded"]})]}):d||(r=Object(a.jsx)("em",{children:"Waiting for opponent\u2026"})),Object(a.jsx)("div",{className:"actions",children:r})}function m(e){var r=e.name,n=e.winner,t=e.scores;return Object(a.jsxs)("tr",{children:[Object(a.jsxs)("td",{children:[r,n&&Object(a.jsx)("span",{role:"img","aria-label":"Winner",children:"\ud83c\udfc6"})]}),t.map((function(e,r){return Object(a.jsx)("td",{children:Object(a.jsx)(b,{points:e})},r)})),Object(a.jsx)("td",{children:Object(a.jsx)(b,{points:Object(o.h)(t)})})]})}function x(e){var r=e.G,n=e.ctx,t=e.playerID,s=e.moves,d=e.matchData,l=Object(i.useState)(void 0),b=Object(c.a)(l,2),f=b[0],x=b[1],k=Object(i.useState)(void 0),y=Object(c.a)(k,2),C=y[0],g=y[1];Object(i.useEffect)((function(){x(void 0),g(void 0)}),[x,g,n.turn]);var w=d.find((function(e){return e.id!==Number(t)})),P=w.id.toString(),S=n.currentPlayer===t,_=n.activePlayers?n.activePlayers[t]:"playCard";if(n.gameover){var D=r.scores[t].length;return Object(a.jsxs)("div",{className:"gameover",children:[Object(a.jsxs)("table",{children:[Object(a.jsx)("thead",{children:Object(a.jsxs)("tr",{children:[Object(a.jsx)("th",{children:"Player"}),Object(o.f)(D).map((function(e){return Object(a.jsxs)("th",{children:["Round ",e+1]},e)})),Object(a.jsx)("th",{children:"Total"})]})}),Object(a.jsxs)("tbody",{children:[Object(a.jsx)(m,{name:"You",scores:r.scores[t],winner:n.gameover.winner===t}),Object(a.jsx)(m,{name:w.name,scores:r.scores[P],winner:n.gameover.winner===P})]})]}),Object(a.jsx)(u.b,{to:"/new",children:"Click to play another game"})]})}return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(j,{deckSize:r.deckSize,round:n.phase}),Object(a.jsx)(O,{cards:r.played[P],scores:r.scores[P],caption:"".concat(w.name,"'s cards")}),Object(a.jsx)(h,{G:r,ctx:n,onPickSuit:g,pickedSuit:C,disabled:!S||"drawCard"!==_}),Object(a.jsx)(O,{cards:r.played[t],scores:r.scores[t],caption:"Your cards"}),Object(a.jsx)(p,{cards:r.players[t].hand,onPickCard:x,pickedCard:f,disabled:!S||"playCard"!==_}),Object(a.jsx)(v,{G:r,ctx:n,moves:s,card:f,suit:C,stage:_,active:S})]})}}}]);
//# sourceMappingURL=4.5bcf165c.chunk.js.map