(this.webpackJsonpboardgames=this.webpackJsonpboardgames||[]).push([[8],{588:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var a=r(50),n=r(1),c={STRIP_SECRETS:function(e,t,r){var c=Object(n.a)({},e);return void 0!==c.secret&&delete c.secret,c.players&&(c.players=Object(a.a)({},r,c.players[r])),c}}},592:function(e,t,r){"use strict";r.r(t),r.d(t,"NIGIRIS",(function(){return S})),r.d(t,"ROLLS",(function(){return E})),r.d(t,"APPETIZERS",(function(){return P})),r.d(t,"SPECIALS",(function(){return I})),r.d(t,"DESSERTS",(function(){return z})),r.d(t,"scoreHand",(function(){return D})),r.d(t,"scoreCard",(function(){return U})),r.d(t,"getNumRound",(function(){return C}));var a=r(200),n=r(203),c=r(75),u=r(201);var o=r(1),i=r(20),s=r(27),l=r(11),f=r(3),p=r(588),m=r(199),b=2,d=8,v=["square","circle","triangle","rectangle"],O=["watermelon","pineapple","orange"],j=[].concat(Object(l.a)(Object(m.f)(2).map((function(e){return O.map((function(e){return[e,e]}))})).flat()),Object(l.a)(Object(m.f)(3).map((function(e){return Object(m.d)(O)})).flat())),y="Dessert",h="Appetizer",g="Rolls",k="Nigiri",w="Special",S={egg:"Egg",salmon:"Salmon",squid:"Squid"},E={maki:"Maki",temaki:"Temaki",uramaki:"Uramaki"},P={tempura:"Tempura",sashimi:"Sashimi",misoSoup:"Miso Soup",tofu:"Tofu",eel:"Eel",dumpling:"Dumpling",onigiri:"Onigiri",edamame:"Edamame"},I={wasabi:"Wasabi",tea:"Tea",soySauce:"Soy Sauce"},z={matchaIceCream:"Matcha Ice Cream",pudding:"Pudding",fruit:"Fruit"};function D(e,t,r){var a=Object(m.h)(e.map((function(a){return U(a,e,t,r)}))),n=t.some((function(e){return e.some((function(e){return e.name===z.fruit}))})),c=e.some((function(e){return e.name===z.fruit}));return n&&!c&&(a-=6),a}function U(e,t,r,a){if(e.scored)return 0;if(e.category===y&&3!==a)return 0;var n=function(t){return t.filter((function(t){return t.name===e.name}))},c=function(e){return Object(m.h)(n(e).map((function(e){return e.count})))},u=function(e){return m.a.apply(void 0,Object(l.a)(e.filter((function(e){return null==e.round})).map((function(e){return e.category})))).length},o=r.length+1,f=void 0,p=void 0,b=!1,d=0;switch(e.name){case S.egg:d=1;break;case S.salmon:d=2;break;case S.squid:d=3;break;case E.maki:var j=c(t),h=r.map((function(e){return c(e)})),g=m.a.apply(void 0,[j].concat(Object(l.a)(h))).sort().reverse(),w=g[0],D=g[1];if(o<=5)d=j===w?6:j===D?3:0;else{var R=g[2];d=j===w?6:j===D?4:j===R?2:0}b=!0;break;case E.temaki:var T=c(t),C=r.map((function(e){return c(e)})),M=m.a.apply(void 0,[T].concat(Object(l.a)(C))).sort().reverse(),_=M[0],A=Object(m.c)(M);T===_&&(d=4),o>2&&T===A&&(d=-4),b=!0;break;case E.uramaki:for(var N=[2,5,8],q=[t].concat(Object(l.a)(r)).map((function(e){return e.filter((function(e){return null==e.round}))})),x=q[0].length,L=Object(m.f)(o).map((function(e){return[]})),G=0;G<x;G++){for(var J=0;J<o;J++){var F=q[J][G];F.name===E.uramaki&&L[J].push(F.count)}for(var H=[],V=function(e){var t=Object(m.h)(L[e]);if(t>=10){var r=H.find((function(e){return e.numUramakis===t}));null==r?H.push({numUramakis:t,players:[e]}):r.players.push(e)}},W=0;W<o;W++)V(W);H.sort((function(e,t){return t.numUramakis-e.numUramakis}));for(var Z=0,B=H;Z<B.length;Z++){var K,Q=B[Z].players,X=N.pop()||0,Y=Object(s.a)(Q);try{for(Y.s();!(K=Y.n()).done;){var $=K.value;0===$&&(d+=X),L[$]=[]}}catch(Ze){Y.e(Ze)}finally{Y.f()}Q.length>1&&N.pop()}}for(var ee=L.map((function(e,t){return{player:t,count:Object(m.h)(e)}})),te=m.a.apply(void 0,Object(l.a)(ee.map((function(e){return e.count})))).sort();N.length>0&&te.length>0;){var re,ae=N.pop(),ne=te.pop(),ce=Object(s.a)(ee);try{for(ce.s();!(re=ce.n()).done;){var ue=re.value,oe=ue.player;ue.count===ne&&0===oe&&(d+=ae)}}catch(Ze){ce.e(Ze)}finally{ce.f()}}b=!0;break;case P.tempura:f=2,p=5;break;case P.sashimi:f=3,p=10;break;case P.misoSoup:var ie=t.filter((function(e){return null==e.round})).indexOf(e);d=r.some((function(e){return e.filter((function(e){return null==e.round}))[ie].name===P.misoSoup}))?0:3;break;case P.tofu:var se=n(t).length;1===se?d=2:2===se?d=6:se>=3&&(d=0),b=!0;break;case P.eel:var le=n(t).length;1===le?d=-3:le>=2&&(d=7),b=!0;break;case P.dumpling:var fe=n(t).length;1===fe?d=1:2===fe?d=3:3===fe?d=6:4===fe?d=10:fe>=5&&(d=15),b=!0;break;case P.onigiri:var pe,me=Object.fromEntries(v.map((function(e){return[e,0]}))),be=Object(s.a)(n(t));try{for(be.s();!(pe=be.n()).done;){me[pe.value.variants[0]]++}}catch(Ze){be.e(Ze)}finally{be.f()}for(;;){var de=Object.entries(me).filter((function(e){var t=Object(i.a)(e,2);t[0];return t[1]>0})).map((function(e){var t=Object(i.a)(e,2),r=t[0];t[1];return r})),ve=de.length;if(0===ve)break;4===ve?d+=16:3===ve?d+=9:2===ve?d+=4:1===ve&&(d+=1);var Oe,je=Object(s.a)(de);try{for(je.s();!(Oe=je.n()).done;){me[Oe.value]--}}catch(Ze){je.e(Ze)}finally{je.f()}}b=!0;break;case P.edamame:var ye=r.filter((function(e){return n(e).length>0})).length;d=Math.min(4,ye);break;case I.wasabi:var he=t.indexOf(e),ge=t.slice(he).filter((function(e){return!e.scored&&e.category===k}))[0];d=null==ge?0:3*U(ge,t,r,a);break;case I.tea:var ke,we={},Se=Object(s.a)(t);try{for(Se.s();!(ke=Se.n()).done;){var Ee=ke.value;we[Ee.category]=(we[Ee.category]||0)+1}}catch(Ze){Se.e(Ze)}finally{Se.f()}d=Math.max.apply(Math,Object(l.a)(Object.values(we)));break;case I.soySauce:var Pe=u(t),Ie=r.map((function(e){return u(e)})),ze=m.a.apply(void 0,[Pe].concat(Object(l.a)(Ie))).sort().reverse();Pe===ze[0]&&(d=4);break;case z.matchaIceCream:f=4,p=12;break;case z.pudding:var De=n(t).length,Ue=r.map((function(e){return n(e).length})),Re=m.a.apply(void 0,[De].concat(Object(l.a)(Ue))).sort().reverse(),Te=Re[0],Ce=Object(m.c)(Re);De===Te&&(d=6),o>2&&De===Ce&&(d=-6),b=!0;break;case z.fruit:var Me,_e=Object.fromEntries(O.map((function(e){return[e,0]}))),Ae=Object(s.a)(n(t));try{for(Ae.s();!(Me=Ae.n()).done;){var Ne,qe=Me.value,xe=Object(s.a)(qe.variants);try{for(xe.s();!(Ne=xe.n()).done;){_e[Ne.value]++}}catch(Ze){xe.e(Ze)}finally{xe.f()}}}catch(Ze){Ae.e(Ze)}finally{Ae.f()}for(var Le=0,Ge=Object.values(_e);Le<Ge.length;Le++){var Je=Ge[Le];0===Je?d-=2:1===Je?d+=0:2===Je?d+=1:3===Je?d+=3:4===Je?d+=6:Je>=5&&(d+=10)}b=!0;break;default:throw new Error("Unknown card: ".concat(e.name))}if(null!=p&&null!=f){var Fe=n(t);d=Math.floor(Fe.length/f)*p,b=!0}if(b){var He,Ve=n(t),We=Object(s.a)(Ve);try{for(We.s();!(He=We.n()).done;){He.value.scored=!0}}catch(Ze){We.e(Ze)}finally{We.f()}}else e.scored=!0;return d}function R(e){switch(e){case 2:case 3:return 10;case 4:case 5:return 9;case 6:case 7:return 8;case 8:return 7;default:throw new Error("Unknown player count: ".concat(e))}}function T(e,t,r){var a,n,c=[];switch((r=(null===e||void 0===e?void 0:e.setupData)||r).rolls){case E.maki:c=[].concat(Object(l.a)(Object(m.f)(4).map((function(e){return{category:g,name:E.maki,count:1}}))),Object(l.a)(Object(m.f)(5).map((function(e){return{category:g,name:E.maki,count:2}}))),Object(l.a)(Object(m.f)(3).map((function(e){return{category:g,name:E.maki,count:3}}))));break;case E.temaki:c=Object(m.f)(12).map((function(e){return{category:g,name:E.temaki,count:1}}));break;case E.uramaki:c=[].concat(Object(l.a)(Object(m.f)(4).map((function(e){return{category:g,name:E.uramaki,count:3}}))),Object(l.a)(Object(m.f)(4).map((function(e){return{category:g,name:E.uramaki,count:4}}))),Object(l.a)(Object(m.f)(4).map((function(e){return{category:g,name:E.uramaki,count:5}}))));break;default:throw new Error("Unknown rolls: ".concat(r.rolls))}var u,o,i=[r.appetizer1,r.appetizer2,r.appetizer3],s=[r.special1,r.special2];u=(null===e||void 0===e||null===(a=e.secret)||void 0===a?void 0:a.deck)?e.secret.deck.filter((function(e){return e.category===y})):[],o=(null===e||void 0===e||null===(n=e.secret)||void 0===n?void 0:n.desserts)?Object(l.a)(e.secret.desserts):t.random.Shuffle(Object(m.f)(15).map((function(e){var t={category:y,name:r.dessert};return t.name===z.fruit&&(t.variants=j[e]),t}))),u=u.concat([].concat(Object(l.a)(Object(m.f)(4).map((function(e){return{category:k,name:S.egg}}))),Object(l.a)(Object(m.f)(5).map((function(e){return{category:k,name:S.salmon}}))),Object(l.a)(Object(m.f)(3).map((function(e){return{category:k,name:S.squid}}))),Object(l.a)(c),Object(l.a)(i.map((function(e){return Object(m.f)(8).map((function(t){var r={category:h,name:e};return r.name===P.onigiri&&(r.variants=[v[t%v.length]]),r}))})).flat()),Object(l.a)(s.map((function(e){return Object(m.f)(3).map((function(t){return{category:w,name:e}}))})).flat())));for(var f=function(e,t){switch(e){case 2:case 3:case 4:case 5:switch(t){case 1:return 5;case 2:return 3;case 3:return 2;default:throw new Error("Unknown round number: ".concat(t))}case 6:case 7:case 8:switch(t){case 1:return 7;case 2:return 5;case 3:return 3;default:throw new Error("Unknown round number: ".concat(t))}default:throw new Error("Unknown player count: ".concat(e))}}(t.numPlayers,C(t)),p=0;p<f;p++)u.push(o.pop());return{deck:t.random.Shuffle(u),desserts:o}}function C(e){if(e.gameover)return 3;var t=R(e.numPlayers),r=0===e.turn?e.turn:e.turn-1;return Math.floor(r/t)+1}function M(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=T(e,t,r),n=a.deck,c=a.desserts,u=C(t),s=Object.fromEntries(Object(m.f)(t.numPlayers).map((function(e){return[e,{hand:Object(m.f)(R(t.numPlayers)).map((function(t){var r=n.pop();if(null==r)throw new Error("Not enough cards in deck for player ".concat(e));return r}))}]}))),l=(null===e||void 0===e?void 0:e.played)?Object.fromEntries(Object.entries(e.played).map((function(e){var t=Object(i.a)(e,2);return[t[0],t[1].filter((function(e){return e.category===y})).map((function(e){return Object(o.a)(Object(o.a)({},e),{},{round:u-1})}))]}))):Object.fromEntries(Object(m.f)(t.numPlayers).map((function(e){return[e,[]]})));return{secret:{deck:n,desserts:c},players:s,played:l}}function _(e){var t,r,o=Object.entries(e.scores).map((function(e){var t=Object(i.a)(e,2),r=t[0],a=t[1];return{playerID:r,score:Object(m.h)(a)}})),l=(t=o,Object(a.a)(t)||Object(n.a)(t)||Object(c.a)(t)||Object(u.a)()),f=l[0],p=l.slice(1),b=f.playerID,d=f.score,v=Object.fromEntries(Object.entries(e.played).map((function(e){var t=Object(i.a)(e,2);return[t[0],t[1].filter((function(e){return e.category===y})).length]}))),O=Object(s.a)(p);try{for(O.s();!(r=O.n()).done;){var j=r.value,h=j.playerID,g=j.score;(g>d||g===d&&v[h]>v[b])&&(d=g,b=h)}}catch(k){O.e(k)}finally{O.f()}return{winner:b}}t.default={name:"sashimi-express",minPlayers:b,maxPlayers:d,setupDataSchema:{required:["numPlayers","rolls","appetizer1","appetizer2","appetizer3","special1","special2","dessert"],properties:Object.fromEntries([["numPlayers",{title:"Number of players",type:"integer",minimum:b,maximum:d,default:b}],["rolls",{title:"Rolls",type:"string",enum:Object.values(E),default:Object.values(E)[0]}]].concat(Object(l.a)(Object(m.f)(3).map((function(e){return["appetizer".concat(e+1),{title:"Appetizer ".concat(e+1),type:"string",enum:Object.values(P),default:Object.values(P)[e]}]}))),Object(l.a)(Object(m.f)(2).map((function(e){return["special".concat(e+1),{title:"Special ".concat(e+1),type:"string",enum:Object.values(I),default:Object.values(I)[e]}]}))),[["dessert",{title:"Dessert",type:"string",enum:Object.values(z),default:Object.values(z)[0]}]]))},validateSetupData:function(e,t){var r=[e.appetizer1,e.appetizer2,e.appetizer3],a=[e.special1,e.special2];return m.a.apply(void 0,r).length!==r.length?"All appetizers must be different":m.a.apply(void 0,a).length!==a.length?"All specials must be different":2===t&&r.includes(P.edamame)?"".concat(P.edamame," can't be used in a two player game"):void 0},setup:function(e,t){return Object(o.a)(Object(o.a)({},M(null,e,t)),{},{scores:Object.fromEntries(Object(m.f)(e.numPlayers).map((function(e){return["".concat(e),[]]}))),startingPlayer:"".concat(Object(m.b)(e.numPlayers+1)),setupData:t})},moves:{pickCard:{move:function(e,t,r){if(function(e,t,r){var a=e.players[t.playerID];return null==r?"played_no_card":r>=a.hand.length?"played_unknown_card":null!=a.picked?"played_card_already":void 0}(e,t,r))return f.t;var a=e.players[t.playerID];a.picked=a.hand[r],a.hand=Object(m.g)(a.hand,r)},client:!1}},turn:{activePlayers:{all:f.j.NULL,moveLimit:1},endIf:function(e,t){return Object.values(e.players).every((function(e){return null!=e.picked}))},onEnd:function(e,t){for(var r=0,a=Object.entries(e.players);r<a.length;r++){var n=Object(i.a)(a[r],2),c=n[0],u=n[1];e.played[c].push(u.picked),e.players[c].picked=void 0}if(function(e,t){return Object.values(e.players).every((function(e){return 0===e.hand.length}))}(e)){for(var o=C(t),s=function(){var t=Object(i.a)(f[l],2),r=t[0],a=D(t[1],Object.entries(e.played).filter((function(e){var t=Object(i.a)(e,2),a=t[0];t[1];return a!==r})).map((function(e){var t=Object(i.a)(e,2);t[0];return t[1]})),o);e.scores[r].push(a)},l=0,f=Object.entries(e.played);l<f.length;l++)s();if(3===o){var p=_(e);t.events.endGame(p)}else for(var m=0,b=Object.entries(M(e,t));m<b.length;m++){var d=Object(i.a)(b[m],2),v=d[0],O=d[1];e[v]=O}}else{for(var j={},y=0,h=Object.entries(e.players);y<h.length;y++){var g=Object(i.a)(h[y],2),k=g[0],w=g[1];j[(Number(k)+1)%t.numPlayers]=w.hand}for(var S=0,E=Object.entries(j);S<E.length;S++){var P=Object(i.a)(E[S],2),I=P[0],z=P[1];e.players[I]={hand:z}}}}},playerView:p.a.STRIP_SECRETS,events:{endStage:!1,endTurn:!1,endPhase:!1,endGame:!1,setStage:!1,setPhase:!1,setActivePlayers:!1},disableUndo:!0}}}]);
//# sourceMappingURL=8.80abc600.chunk.js.map