(this.webpackJsonpboardgames=this.webpackJsonpboardgames||[]).push([[4,7,10],{589:function(e,r,n){"use strict";n.d(r,"a",(function(){return a}));var t=n(52),c=n(1),a={STRIP_SECRETS:function(e,r,n){var a=Object(c.a)({},e);return void 0!==a.secret&&delete a.secret,a.players&&(a.players=Object(t.a)({},n,a.players[n])),a}}},593:function(e,r,n){"use strict";n.r(r),n.d(r,"isBet",(function(){return h})),n.d(r,"toOrdinal",(function(){return f})),n.d(r,"scoreSuit",(function(){return p})),n.d(r,"canPlayCardToBoard",(function(){return x})),n.d(r,"canPlayCardToDiscard",(function(){return k})),n.d(r,"canDrawCardFromDeck",(function(){return y})),n.d(r,"canDrawCardFromDiscard",(function(){return C}));var t=n(52),c=n(12),a=n(1),i=n(21),s=n(3),d=n(589),u=n(200),l=["yellow","blue","white","green","red"],o=[-1,-2,-3],j=[2,3,4,5,6,7,8,9,10],b="0",O="1";function h(e){return o.includes(e.rank)}function f(e){return 100*(l.indexOf(e.suit)+1)+e.rank}function p(e){if(0===e.length)return 0;var r=Object(u.e)(e,(function(e){return h(e)})),n=r.true,t=r.false,c=n.length;return(Object(u.h)(t.map((function(e){return e.rank})))-20)*(c+1)+(e.length>=8?20:0)}function v(e){for(var r,n,a=e.random.Shuffle(l.flatMap((function(e){return[].concat(Object(c.a)(j.map((function(r){return{suit:e,rank:r}}))),Object(c.a)(o.map((function(r){return{suit:e,rank:r}}))))}))),i=[],s=[],d=0;d<8;d++)i.push(a.pop()),s.push(a.pop());var u=function(){return Object.fromEntries(l.map((function(e){return[e,[]]})))};return{secret:{deck:a},players:(r={},Object(t.a)(r,b,{hand:i}),Object(t.a)(r,O,{hand:s}),r),played:(n={},Object(t.a)(n,b,u()),Object(t.a)(n,O,u()),n),discarded:u(),deckSize:a.length}}function m(e,r,n){return e.players[r.currentPlayer].hand.findIndex((function(e){var r=e.rank,t=e.suit;return r===n.rank&&t===n.suit}))}function x(e,r,n){if(-1===m(e,r,n))return"card_not_in_player_hand";var t=Object(u.c)(e.played[r.currentPlayer][n.suit]);return null!=t&&!h(t)&&n.rank<t.rank?"card_out_of_order":void 0}function k(e,r,n){if(-1===m(e,r,n))return"card_not_in_player_hand"}function y(e,r){if(0===e.deckSize)return"deck_empty"}function C(e,r,n){if(!l.includes(n))return"unknown_discard_pile";var t=Object(u.c)(e.discarded[n]);return null==t?"cannot_draw_from_empty_discard_pile":t.turn===r.turn?"cannot_draw_just_discarded_card":void 0}var g={name:"soaring-cities",minPlayers:2,maxPlayers:2,setup:function(e){var r;return Object(a.a)({scores:(r={},Object(t.a)(r,b,[]),Object(t.a)(r,O,[]),r),round:0},v(e))},moves:{playCardToBoard:{move:function(e,r,n){if(null!=x(e,r,n))return s.t;var t=m(e,r,n);e.players[r.currentPlayer].hand.splice(t,1),e.played[r.currentPlayer][n.suit].push(Object(a.a)(Object(a.a)({},n),{},{turn:r.turn})),r.events.setStage("drawCard")},client:!1},playCardToDiscard:{move:function(e,r,n){if(null!=k(e,r,n))return s.t;var t=m(e,r,n);e.players[r.currentPlayer].hand.splice(t,1),e.discarded[n.suit].push(Object(a.a)(Object(a.a)({},n),{},{turn:r.turn})),r.events.setStage("drawCard")},client:!1}},turn:{onBegin:function(e){return Object(a.a)(Object(a.a)({},e),{},{deckSize:e.secret.deck.length})},stages:{drawCard:{moves:{drawCardFromDeck:{move:function(e,r){if(null!=y(e))return s.t;var n=e.secret.deck.pop();if(e.players[r.currentPlayer].hand.push(n),0===e.secret.deck.length){var t=function(e,r){for(var n=0,t=[b,O];n<t.length;n++){var c=t[n],a=Object.values(Object.values(e.played[c])),s=Object(u.h)(a.map((function(e){return p(e)})));e.scores[c].push(s)}var d,l=Object(u.h)(e.scores[0]),o=Object(u.h)(e.scores[1]);d=l>o?b:o>l||r.currentPlayer===b?O:b,e.round++;for(var j=0,h=Object.entries(v(r));j<h.length;j++){var f=Object(i.a)(h[j],2),m=f[0],x=f[1];e[m]=x}return d}(e,r);r.events.endTurn({next:t})}else r.events.endTurn()},client:!1},drawCardFromDiscard:{move:function(e,r,n){if(null!=C(e,r,n))return s.t;var t=e.discarded[n].pop();e.players[r.currentPlayer].hand.push(t),r.events.endTurn()},client:!1}}}}},endIf:function(e){if(!(e.round<3)){var r=Object(u.h)(e.scores[0]),n=Object(u.h)(e.scores[1]);return{winner:r>n?b:n>r?O:"tied"}}},playerView:d.a.STRIP_SECRETS,events:{endStage:!1,endTurn:!1,endPhase:!1,endGame:!1,setStage:!1,setPhase:!1,setActivePlayers:!1},disableUndo:!0};r.default=g},594:function(e,r,n){},601:function(e,r,n){"use strict";n.r(r),n.d(r,"default",(function(){return x}));var t=n(1),c=n(21),a=n(6),i=n(0),s=n(201),d=n.n(s),u=n(58),l=n(593),o=n(200);n(594);function j(e){var r=e.deckSize,n=e.round;return Object(a.jsxs)("div",{className:"deck",children:["Round ",n+1,", cards remaining: ",r]})}function b(e){var r=e.points,n=r<0?Object(a.jsx)(a.Fragment,{children:"\u2212"}):void 0,t=Math.abs(r);return Object(a.jsxs)("span",{className:"points",children:[n,"$",t,"M"]})}function O(e){var r=e.cards,n=e.scores,i=e.caption;return Object(a.jsxs)("div",{className:"played",children:[Object(a.jsxs)("label",{children:[i,", ",Object(a.jsx)(b,{points:Object(o.h)(n)})]}),Object(a.jsx)("ul",{children:Object.entries(r).map((function(e){var r=Object(c.a)(e,2),n=r[0],i=r[1];return Object(a.jsx)("li",{className:d()("suit",n,"cards-".concat(i.length)),children:Object(a.jsx)("ol",{children:i.map((function(e){return Object(a.jsx)("li",{children:Object(a.jsx)(f,Object(t.a)({},e))},Object(l.toOrdinal)(e))}))})},n)}))})]})}function h(e){var r=e.G,n=e.ctx,s=e.onPickSuit,u=e.pickedSuit,o=e.disabled,j=Object(i.useCallback)((function(e){var r=e.target.value;s(r)}),[s]);return Object(a.jsxs)("div",{className:"discarded",children:[Object(a.jsx)("label",{children:"Discarded cards"}),Object(a.jsx)("ul",{children:Object.entries(r.discarded).map((function(e){var i=Object(c.a)(e,2),s=i[0],b=i[1],O="pickedSuit-".concat(s),h=s===u;return Object(a.jsxs)("li",{className:d()("suit",s,"cards-".concat(b.length),{checked:h}),children:[Object(a.jsx)("ol",{children:b.map((function(e){return Object(a.jsx)("li",{children:Object(a.jsx)(f,Object(t.a)({},e))},Object(l.toOrdinal)(e))}))}),Object(a.jsx)("input",{type:"radio",name:"pickedSuit",value:s,onChange:j,checked:h,disabled:o||null!=Object(l.canDrawCardFromDiscard)(r,n,s),id:O}),Object(a.jsxs)("label",{htmlFor:O,children:["Pick ",s]})]},s)}))})]})}function f(e){return Object(a.jsx)("span",{className:d()("card",e.suit),children:Object(l.isBet)(e)?"bet":e.rank})}function p(e){var r=e.cards,n=e.onPickCard,c=e.pickedCard,s=e.disabled,u=Object(i.useCallback)((function(e){var r=JSON.parse(e.target.value);n(r)}),[n]);return Object(a.jsxs)("div",{className:"hand",children:[Object(a.jsx)("label",{children:"Your hand"}),Object(a.jsx)("ul",{children:r.sort((function(e,r){return Object(l.toOrdinal)(e)-Object(l.toOrdinal)(r)})).map((function(e){var r="pickedCard-".concat(Object(l.toOrdinal)(e)),n=e.suit===(null===c||void 0===c?void 0:c.suit)&&e.rank===(null===c||void 0===c?void 0:c.rank);return Object(a.jsxs)("li",{className:d()({checked:n}),children:[Object(a.jsx)("input",{type:"radio",name:"pickedCard",value:JSON.stringify(e),onChange:u,checked:n,disabled:s,id:r}),Object(a.jsx)("label",{htmlFor:r,children:Object(a.jsx)(f,Object(t.a)({},e))})]},r)}))})]})}function v(e){var r,n=e.G,t=e.ctx,c=e.card,i=e.suit,s=e.moves,d=e.active,u=e.stage;return d&&"playCard"===u?r=Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("button",{onClick:function(){return s.playCardToBoard(c)},disabled:null==c||null!=Object(l.canPlayCardToBoard)(n,t,c),children:"Play card"}),Object(a.jsx)("button",{onClick:function(){return s.playCardToDiscard(c)},disabled:null==c||null!=Object(l.canPlayCardToDiscard)(n,t,c),children:"Discard card"})]}):d&&"drawCard"===u?r=Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("button",{onClick:function(){return s.drawCardFromDeck()},disabled:null!=Object(l.canDrawCardFromDeck)(n,t),children:"Draw card"}),Object(a.jsxs)("button",{onClick:function(){return s.drawCardFromDiscard(i)},disabled:null==i||null!=Object(l.canDrawCardFromDiscard)(n,t,i),children:["Pick ",i||"discarded"]})]}):d||(r=Object(a.jsx)("em",{children:"Waiting for opponent\u2026"})),Object(a.jsx)("div",{className:"actions",children:r})}function m(e){var r=e.name,n=e.winner,t=e.scores;return Object(a.jsxs)("tr",{children:[Object(a.jsxs)("td",{children:[r,n&&Object(a.jsx)("span",{role:"img","aria-label":"Winner",children:"\ud83c\udfc6"})]}),t.map((function(e,r){return Object(a.jsx)("td",{children:Object(a.jsx)(b,{points:e})},r)})),Object(a.jsx)("td",{children:Object(a.jsx)(b,{points:Object(o.h)(t)})})]})}function x(e){var r=e.G,n=e.ctx,t=e.playerID,s=e.moves,d=e.matchData,l=Object(i.useState)(void 0),b=Object(c.a)(l,2),f=b[0],x=b[1],k=Object(i.useState)(void 0),y=Object(c.a)(k,2),C=y[0],g=y[1];Object(i.useEffect)((function(){x(void 0),g(void 0)}),[x,g,n.turn]);var w=d.find((function(e){return e.id!==Number(t)})),P=w.id.toString(),S=n.currentPlayer===t,_=n.activePlayers?n.activePlayers[t]:"playCard";if(n.gameover){var D=r.scores[t].length;return Object(a.jsxs)("div",{className:"gameover",children:[Object(a.jsxs)("table",{children:[Object(a.jsx)("thead",{children:Object(a.jsxs)("tr",{children:[Object(a.jsx)("th",{children:"Player"}),Object(o.f)(D).map((function(e){return Object(a.jsxs)("th",{children:["Round ",e+1]},e)})),Object(a.jsx)("th",{children:"Total"})]})}),Object(a.jsxs)("tbody",{children:[Object(a.jsx)(m,{name:"You",scores:r.scores[t],winner:n.gameover.winner===t}),Object(a.jsx)(m,{name:w.name,scores:r.scores[P],winner:n.gameover.winner===P})]})]}),Object(a.jsx)(u.b,{to:"/new",children:"Click to play another game"})]})}return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(j,{deckSize:r.deckSize,round:r.round}),Object(a.jsx)(O,{cards:r.played[P],scores:r.scores[P],caption:"".concat(w.name,"'s cards")}),Object(a.jsx)(h,{G:r,ctx:n,onPickSuit:g,pickedSuit:C,disabled:!S||"drawCard"!==_}),Object(a.jsx)(O,{cards:r.played[t],scores:r.scores[t],caption:"Your cards"}),Object(a.jsx)(p,{cards:r.players[t].hand,onPickCard:x,pickedCard:f,disabled:!S||"playCard"!==_}),Object(a.jsx)(v,{G:r,ctx:n,moves:s,card:f,suit:C,stage:_,active:S})]})}}}]);
//# sourceMappingURL=4.e170b749.chunk.js.map