{"version":3,"sources":["../node_modules/boardgame.io/dist/esm/core.js","shared/games/lc.js","frontend/boards/lc/index.js"],"names":["PlayerView","STRIP_SECRETS","G","ctx","playerID","r","undefined","secret","players","SUITS","BETS","RANKS","PLAYER_1","PLAYER_2","isBet","card","includes","rank","toOrdinal","indexOf","suit","onRoundEnd","player","played","Object","values","score","sum","map","cards","scoreSuit","scores","push","player1Score","player2Score","turnOrder","onRoundStart","deck","random","Shuffle","flatMap","hand1","hand2","i","pop","newCards","fromEntries","hand","discarded","deckSize","length","dealCards","partition","bets","true","ranks","false","numBets","findCardIndex","currentPlayer","findIndex","canPlayCardToBoard","previousCard","last","canPlayCardToDiscard","canDrawCardFromDeck","_ctx","canDrawCardFromDiscard","turn","game","name","minPlayers","maxPlayers","setup","moves","playCardToBoard","move","INVALID_MOVE","splice","events","setStage","client","playCardToDiscard","onBegin","order","TurnOrder","CUSTOM_FROM","stages","drawCard","drawCardFromDeck","endTurn","endPhase","drawCardFromDiscard","phases","range","start","next","NUM_ROUNDS","onEnd","endIf","phase","winner","playerView","endStage","endGame","setPhase","setActivePlayers","disableUndo","Deck","round","className","Points","points","sign","value","Math","abs","Played","caption","entries","classNames","Card","Discarded","onPickSuit","pickedSuit","disabled","onChange","useCallback","event","target","id","checked","type","htmlFor","Hand","onPickCard","pickedCard","JSON","parse","sort","card1","card2","stringify","Actions","content","active","stage","onClick","ScoreRow","role","aria-label","Board","matchData","useState","setPickedCard","setPickedSuit","useEffect","opponent","find","u","Number","otherPlayerID","toString","isActive","activePlayers","gameover","numRounds","to"],"mappings":"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","file":"static/js/4.5bcf165c.chunk.js","sourcesContent":["export { v as ActivePlayers, h as INVALID_MOVE, S as Stage, T as TurnOrder } from './turn-order-7578f7f3.js';\nimport 'immer';\n\n/*\r\n * Copyright 2018 The boardgame.io Authors\r\n *\r\n * Use of this source code is governed by a MIT-style\r\n * license that can be found in the LICENSE file or at\r\n * https://opensource.org/licenses/MIT.\r\n */\r\n/**\r\n * PlayerView reducers.\r\n */\r\nconst PlayerView = {\r\n    /**\r\n     * STRIP_SECRETS\r\n     *\r\n     * Reducer which removes a key named `secret` and\r\n     * removes all the keys in `players`, except for the one\r\n     * corresponding to the current playerID.\r\n     */\r\n    STRIP_SECRETS: (G, ctx, playerID) => {\r\n        let r = { ...G };\r\n        if (r.secret !== undefined) {\r\n            delete r.secret;\r\n        }\r\n        if (r.players) {\r\n            r.players = {\r\n                [playerID]: r.players[playerID],\r\n            };\r\n        }\r\n        return r;\r\n    },\r\n};\n\nexport { PlayerView };\n","import { INVALID_MOVE, PlayerView, TurnOrder } from 'boardgame.io/core';\nimport { last, partition, range, sum } from '../utils';\n\n/** @typedef {import('boardgame.io/dist/types/src/types').Ctx} Ctx **/\n\n/**\n * @typedef {object} Card\n * @property {string} suit\n * @property {number} rank\n *\n * @typedef {{\n *   [suit: string]: (Card & { turn: number })[],\n * }} Cards\n *\n * @typedef {{\n *   secret: {\n *     deck: Card[],\n *   },\n *   players: {\n *     [player: string]: {\n *       hand: Card[],\n *     },\n *   },\n *   played: {\n *     [player: string]: Cards,\n *   },\n *   discarded: Cards,\n *   deckSize: number,\n * }} GameState\n *\n * @typedef {{\n *   scores: {\n *     [player: string]: number[],\n *   },\n *   turnOrder: string[],\n * }} GameContext\n *\n * @typedef {GameState & GameContext} G\n */\n\nconst SUITS = ['yellow', 'blue', 'white', 'green', 'red' ];\nconst BETS = [-1, -2, -3];\nconst RANKS = [2, 3, 4, 5, 6, 7, 8, 9, 10];\n\nconst NUM_ROUNDS = 3;\nconst HAND_SIZE = 8;\n\nconst PLAYER_1 = '0';\nconst PLAYER_2 = '1';\n\n/**\n * @param {Card} card\n * @returns {boolean}\n */\nexport function isBet(card) {\n  return BETS.includes(card.rank);\n}\n\n/**\n * @param {Card} card\n * @returns {number}\n */\nexport function toOrdinal(card) {\n  return (SUITS.indexOf(card.suit) + 1) * 100 + card.rank;\n}\n\n/**\n * @param {G} G\n * @param {Ctx} ctx\n * @returns {{ winner: string }?}\n */\nfunction checkGameOver(G, ctx) {\n  if (ctx.phase != null) {\n    return undefined;\n  }\n\n  const player1Score = sum(G.scores[PLAYER_1]);\n  const player2Score = sum(G.scores[PLAYER_2]);\n\n  let winner;\n\n  if (player1Score > player2Score) {\n    winner = PLAYER_1;\n  } else if (player2Score > player1Score) {\n    winner = PLAYER_2;\n  } else {\n    winner = 'tied';\n  }\n\n  return { winner };\n}\n\n/**\n * @param {G} G\n */\nfunction onRoundEnd(G) {\n  for (const player of [PLAYER_1, PLAYER_2]) {\n    const played = Object.values(Object.values(G.played[player]));\n    const score = sum(played.map(cards => scoreSuit(cards)));\n    G.scores[player].push(score);\n  }\n\n  const player1Score = sum(G.scores[PLAYER_1]);\n  const player2Score = sum(G.scores[PLAYER_2]);\n\n  if (player1Score > player2Score) {\n    G.turnOrder = [PLAYER_1, PLAYER_2];\n  } else if (player2Score > player1Score) {\n    G.turnOrder = [PLAYER_2, PLAYER_1];\n  } else {\n    G.turnOrder = [G.turnOrder[1], G.turnOrder[0]];\n  }\n}\n\n/**\n * @param {G} G\n * @param {Ctx} ctx\n * @returns {G}\n */\nfunction onRoundStart(G, ctx) {\n  return { ...G, ...dealCards(ctx) };\n}\n\n/**\n * @param {G} G\n * @returns {G}\n */\nfunction onTurnStart(G) {\n  return { ...G, deckSize: G.secret.deck.length };\n}\n\n/**\n * @param {Card[]} cards\n * @returns {number}\n */\nexport function scoreSuit(cards) {\n  if (cards.length === 0) {\n    return 0;\n  }\n\n  const { true: bets, false: ranks } = partition(cards, card => isBet(card));\n\n  const numBets = bets.length;\n  const score = sum(ranks.map(card => card.rank));\n  const bonus = cards.length >= 8 ? 20 : 0;\n\n  return (score - 20) * (numBets + 1) + bonus;\n}\n\n/**\n * @param {Ctx} ctx\n * @returns {GameState}\n */\nfunction dealCards(ctx) {\n  const deck = ctx.random.Shuffle(\n    SUITS.flatMap(suit => [\n      ...RANKS.map(rank => ({ suit, rank })),\n      ...BETS.map(rank => ({ suit, rank })),\n    ])\n  );\n\n  const hand1 = [];\n  const hand2 = [];\n\n  for (let i = 0; i < HAND_SIZE; i++) {\n    hand1.push(deck.pop());\n    hand2.push(deck.pop());\n  }\n\n  const newCards = () => Object.fromEntries(SUITS.map(suit => [suit, []]));\n\n  return {\n    secret: {\n      deck,\n    },\n    players: {\n      [PLAYER_1]: {\n        hand: hand1,\n      },\n      [PLAYER_2]: {\n        hand: hand2,\n      },\n    },\n    played: {\n      [PLAYER_1]: newCards(),\n      [PLAYER_2]: newCards(),\n    },\n    discarded: newCards(),\n    deckSize: deck.length,\n  };\n}\n\n/**\n * @param {G} G\n * @param {Ctx} ctx\n * @param {Card} card\n * @returns {number}\n */\nfunction findCardIndex(G, ctx, card) {\n  return G.players[ctx.currentPlayer].hand.findIndex(({ rank, suit }) => rank === card.rank && suit === card.suit);\n}\n\n/**\n * @param {G} G\n * @param {Ctx} ctx\n * @param {Card} card\n * @returns {string=}\n */\nexport function canPlayCardToBoard(G, ctx, card) {\n  const i = findCardIndex(G, ctx, card);\n\n  if (i === -1) {\n    return 'card_not_in_player_hand';\n  }\n\n  const previousCard = last(G.played[ctx.currentPlayer][card.suit]);\n\n  if (previousCard != null && !isBet(previousCard) && card.rank < previousCard.rank) {\n    return 'card_out_of_order';\n  }\n\n  return undefined;\n}\n\n/**\n * @param {G} G\n * @param {Ctx} ctx\n * @param {Card} card\n * @returns {INVALID_MOVE=}\n */\nfunction playCardToBoard(G, ctx, card) {\n  if (canPlayCardToBoard(G, ctx, card) != null) {\n    return INVALID_MOVE;\n  }\n\n  const i = findCardIndex(G, ctx, card);\n  G.players[ctx.currentPlayer].hand.splice(i, 1);\n  G.played[ctx.currentPlayer][card.suit].push({ ...card, turn: ctx.turn });\n  ctx.events.setStage('drawCard');\n}\n\n/**\n * @param {G} G\n * @param {Ctx} ctx\n * @param {Card} card\n * @returns {string=}\n */\nexport function canPlayCardToDiscard(G, ctx, card) {\n  const i = findCardIndex(G, ctx, card);\n\n  if (i === -1) {\n    return 'card_not_in_player_hand';\n  }\n\n  return undefined;\n}\n\n/**\n * @param {G} G\n * @param {Ctx} ctx\n * @param {Card} card\n * @returns {INVALID_MOVE=}\n */\nfunction playCardToDiscard(G, ctx, card) {\n  if (canPlayCardToDiscard(G, ctx, card) != null) {\n    return INVALID_MOVE;\n  }\n\n  const i = findCardIndex(G, ctx, card);\n  G.players[ctx.currentPlayer].hand.splice(i, 1);\n  G.discarded[card.suit].push({ ...card, turn: ctx.turn });\n  ctx.events.setStage('drawCard');\n}\n\n/**\n * @param {G} G\n * @param {Ctx} _ctx\n * @returns {string=}\n */\nexport function canDrawCardFromDeck(G, _ctx) {\n  if (G.deckSize === 0) {\n    return 'deck_empty';\n  }\n\n  return undefined;\n}\n\n/**\n * @param {G} G\n * @param {Ctx} ctx\n * @returns {INVALID_MOVE=}\n */\nfunction drawCardFromDeck(G, ctx) {\n  if (canDrawCardFromDeck(G, ctx) != null) {\n    return INVALID_MOVE;\n  }\n\n  const card = G.secret.deck.pop();\n  G.players[ctx.currentPlayer].hand.push(card);\n  ctx.events.endTurn();\n\n  if (G.secret.deck.length === 0) {\n    ctx.events.endPhase();\n  }\n}\n\n/**\n * @param {G} G\n * @param {Ctx} ctx\n * @param {string} suit\n * @returns {string=}\n */\nexport function canDrawCardFromDiscard(G, ctx, suit) {\n  if (!SUITS.includes(suit)) {\n    return 'unknown_discard_pile';\n  }\n\n  const card = last(G.discarded[suit]);\n\n  if (card == null) {\n    return 'cannot_draw_from_empty_discard_pile';\n  }\n\n  if (card.turn === ctx.turn) {\n    return 'cannot_draw_just_discarded_card';\n  }\n\n  return undefined;\n}\n\n/**\n * @param {G} G\n * @param {Ctx} ctx\n * @param {string} suit\n * @returns {INVALID_MOVE?}\n */\nfunction drawCardFromDiscard(G, ctx, suit) {\n  if (canDrawCardFromDiscard(G, ctx, suit) != null) {\n    return INVALID_MOVE;\n  }\n\n  const card = G.discarded[suit].pop();\n  G.players[ctx.currentPlayer].hand.push(card);\n  ctx.events.endTurn();\n}\n\nconst game = {\n  name: 'soaring-cities',\n\n  minPlayers: 2,\n  maxPlayers: 2,\n\n  /**\n   * @returns {GameContext}\n   */\n  setup: () => ({\n    scores: {\n      [PLAYER_1]: [],\n      [PLAYER_2]: [],\n    },\n    turnOrder: [PLAYER_1, PLAYER_2],\n  }),\n\n  moves: {\n    playCardToBoard: {\n      move: playCardToBoard,\n      client: false,\n    },\n    playCardToDiscard: {\n      move: playCardToDiscard,\n      client: false,\n    },\n  },\n\n  turn: {\n    onBegin: onTurnStart,\n\n    order: TurnOrder.CUSTOM_FROM('turnOrder'),\n\n    stages: {\n      drawCard: {\n        moves: {\n          drawCardFromDeck: {\n            move: drawCardFromDeck,\n            client: false,\n          },\n          drawCardFromDiscard: {\n            move: drawCardFromDiscard,\n            client: false,\n          },\n        },\n      },\n    },\n  },\n\n  phases: Object.fromEntries(range(NUM_ROUNDS).map(i => ([\n    `Round ${i + 1}`,\n    {\n      start: i === 0,\n      next: i === NUM_ROUNDS - 1 ? undefined : `Round ${i + 2}`,\n      onBegin: onRoundStart,\n      onEnd: onRoundEnd,\n    },\n  ]))),\n\n  endIf: checkGameOver,\n\n  playerView: PlayerView.STRIP_SECRETS,\n\n  events: {\n    endStage: false,\n    endTurn: false,\n    endPhase: false,\n    endGame: false,\n    setStage: false,\n    setPhase: false,\n    setActivePlayers: false,\n  },\n\n  disableUndo: true,\n};\n\nexport default game;\n","import React, { useCallback, useEffect, useState } from 'react';\nimport classNames from 'classnames';\nimport { Link } from 'react-router-dom';\nimport { canDrawCardFromDeck, canDrawCardFromDiscard, canPlayCardToBoard, canPlayCardToDiscard, isBet, toOrdinal } from '../../../shared/games/lc';\nimport { range, sum } from '../../../shared/utils';\nimport './index.scss';\n\n/** @typedef {import('react').ChangeEvent<HTMLInputElement>} InputChangeEvent **/\n/** @typedef {import('boardgame.io/dist/types/src/types').Ctx} Ctx **/\n/** @typedef {import('boardgame.io/dist/types/src/types').LobbyAPI.Match} Match **/\n/** @typedef {import('../../../shared/games/lc').G} G */\n/** @typedef {import('../../../shared/games/lc').Card} Card */\n/** @typedef {import('../../../shared/games/lc').Cards} Cards */\n\n/**\n * @param {object} props\n * @param {number} props.deckSize\n * @param {string} props.round\n */\nfunction Deck({ deckSize, round }) {\n  return (\n    <div className=\"deck\">\n      {round}, cards remaining: {deckSize}\n    </div>\n  );\n}\n\n/**\n * @param {object} props\n * @param {number} props.points\n */\nfunction Points({ points }) {\n  const sign = points < 0 ? <>&minus;</> : undefined;\n  const value = Math.abs(points);\n\n  return (\n    <span className=\"points\">\n      {sign}${value}M\n    </span>\n  )\n}\n\n/**\n * @param {object} props\n * @param {Cards} props.cards\n * @param {number[]} props.scores\n * @param {string} props.caption\n */\nfunction Played({ cards, scores, caption }) {\n  return (\n    <div className=\"played\">\n      <label>{caption}, <Points points={sum(scores)} /></label>\n      <ul>\n        {Object.entries(cards).map(([suit, cards]) => (\n          <li key={suit} className={classNames('suit', suit, `cards-${cards.length}`)}>\n            <ol>\n              {cards.map(card => (\n                <li key={toOrdinal(card)}>\n                  <Card {...card} />\n                </li>\n              ))}\n            </ol>\n          </li>\n        ))}\n      </ul>\n    </div>\n  );\n}\n\n/**\n * @param {object} props\n * @param {G} props.G\n * @param {Ctx} props.ctx\n * @param {any} props.onPickSuit\n * @param {string} props.pickedSuit\n * @param {boolean} props.disabled\n */\nfunction Discarded({ G, ctx, onPickSuit, pickedSuit, disabled }) {\n  const onChange = useCallback((/** @type {InputChangeEvent} */ event) => {\n    const suit = event.target.value;\n    onPickSuit(suit);\n  }, [onPickSuit]);\n\n  return (\n    <div className=\"discarded\">\n      <label>Discarded cards</label>\n      <ul>\n        {Object.entries(G.discarded).map(([suit, cards]) => {\n          const id = `pickedSuit-${suit}`;\n          const checked = suit === pickedSuit;\n          return (\n            <li key={suit} className={classNames('suit', suit, `cards-${cards.length}`, { checked })}>\n              <ol>\n                {cards.map(card => (\n                  <li key={toOrdinal(card)}>\n                    <Card {...card} />\n                  </li>\n                ))}\n              </ol>\n              <input\n                type=\"radio\"\n                name=\"pickedSuit\"\n                value={suit}\n                onChange={onChange}\n                checked={checked}\n                disabled={disabled || canDrawCardFromDiscard(G, ctx, suit) != null}\n                id={id}\n              />\n              <label htmlFor={id}>\n                Pick {suit}\n              </label>\n            </li>\n          );\n        })}\n      </ul>\n    </div>\n  );\n}\n\n/**\n * @param {Card} card\n */\nfunction Card(card) {\n  return (\n    <span className={classNames('card', card.suit)}>\n      {isBet(card) ? 'bet' : card.rank}\n    </span>\n  )\n}\n\n/**\n * @param {object} props\n * @param {Card[]} props.cards\n * @param {any} props.onPickCard\n * @param {Card} props.pickedCard\n * @param {boolean} props.disabled\n */\nfunction Hand({ cards, onPickCard, pickedCard, disabled }) {\n  const onChange = useCallback((/** @type {InputChangeEvent} */ event) => {\n    const card = JSON.parse(event.target.value);\n    onPickCard(card);\n  }, [onPickCard]);\n\n  return (\n    <div className=\"hand\">\n      <label>Your hand</label>\n      <ul>\n        {cards.sort((card1, card2) => toOrdinal(card1) - toOrdinal(card2)).map((card) => {\n          const id = `pickedCard-${toOrdinal(card)}`;\n          const checked = card.suit === pickedCard?.suit && card.rank === pickedCard?.rank;\n          return (\n            <li key={id} className={classNames({ checked })}>\n              <input\n                type=\"radio\"\n                name=\"pickedCard\"\n                value={JSON.stringify(card)}\n                onChange={onChange}\n                checked={checked}\n                disabled={disabled}\n                id={id}\n              />\n              <label htmlFor={id}>\n                <Card {...card} />\n              </label>\n            </li>\n          );\n        })}\n      </ul>\n    </div>\n  );\n}\n\n/**\n * @param {object} props\n * @param {G} props.G\n * @param {Ctx} props.ctx\n * @param {any} props.moves\n * @param {Card=} props.card\n * @param {string=} props.suit\n * @param {boolean} props.active\n * @param {string} props.stage\n */\nfunction Actions({ G, ctx, card, suit, moves, active, stage }) {\n  let content;\n\n  if (active && stage === 'playCard') {\n    content = (\n      <>\n        <button\n          onClick={() => moves.playCardToBoard(card)}\n          disabled={card == null || canPlayCardToBoard(G, ctx, card) != null}\n        >\n          Play card\n        </button>\n        <button\n          onClick={() => moves.playCardToDiscard(card)}\n          disabled={card == null || canPlayCardToDiscard(G, ctx, card) != null}\n        >\n          Discard card\n        </button>\n      </>\n    );\n  } else if (active && stage === 'drawCard') {\n    content = (\n      <>\n        <button\n          onClick={() => moves.drawCardFromDeck()}\n          disabled={canDrawCardFromDeck(G, ctx) != null}\n        >\n          Draw card\n        </button>\n        <button\n          onClick={() => moves.drawCardFromDiscard(suit)}\n          disabled={suit == null || canDrawCardFromDiscard(G, ctx, suit) != null}\n        >\n          Pick {suit || 'discarded'}\n        </button>\n      </>\n    );\n  } else if (!active) {\n    content = <em>Waiting for opponent&hellip;</em>\n  }\n\n  return (\n    <div className=\"actions\">\n      {content}\n    </div>\n  );\n}\n\n/**\n * @param {object} props\n * @param {string} props.name\n * @param {boolean} props.winner\n * @param {number[]} props.scores\n */\nfunction ScoreRow({ name, winner, scores }) {\n  return (\n    <tr>\n      <td>\n        {name}\n        {winner && <span role=\"img\" aria-label=\"Winner\">🏆</span>}\n      </td>\n      {scores.map((score, i) =>\n        <td key={i}><Points points={score} /></td>\n      )}\n      <td><Points points={sum(scores)} /></td>\n    </tr>\n  );\n}\n\n/**\n * @param {object} props\n * @param {G} props.G\n * @param {Ctx} props.ctx\n * @param {string} props.playerID\n * @param {any} props.moves\n * @param {Match['players']} props.matchData\n */\nexport default function Board({ G, ctx, playerID, moves, matchData }) {\n  const [pickedCard, setPickedCard] = useState(undefined);\n  const [pickedSuit, setPickedSuit] = useState(undefined);\n\n  useEffect(() => {\n    setPickedCard(undefined);\n    setPickedSuit(undefined);\n  }, [setPickedCard, setPickedSuit, ctx.turn]);\n\n  const opponent = matchData.find(u => u.id !== Number(playerID));\n  const otherPlayerID = opponent.id.toString();\n  const isActive = ctx.currentPlayer === playerID;\n  const stage = ctx.activePlayers ? ctx.activePlayers[playerID] : 'playCard';\n\n  if (ctx.gameover) {\n    const numRounds = G.scores[playerID].length;\n\n    return (\n      <div className=\"gameover\">\n        <table>\n          <thead>\n            <tr>\n              <th>Player</th>\n              {range(numRounds).map(i =>\n                <th key={i}>Round {i + 1}</th>\n              )}\n              <th>Total</th>\n            </tr>\n          </thead>\n          <tbody>\n            <ScoreRow\n              name=\"You\"\n              scores={G.scores[playerID]}\n              winner={ctx.gameover.winner === playerID}\n            />\n            <ScoreRow\n              name={opponent.name}\n              scores={G.scores[otherPlayerID]}\n              winner={ctx.gameover.winner === otherPlayerID}\n            />\n          </tbody>\n        </table>\n        <Link to=\"/new\">Click to play another game</Link>\n      </div>\n    );\n  }\n\n  return (\n    <>\n      <Deck\n        deckSize={G.deckSize}\n        round={ctx.phase}\n      />\n      <Played\n        cards={G.played[otherPlayerID]}\n        scores={G.scores[otherPlayerID]}\n        caption={`${opponent.name}'s cards`}\n      />\n      <Discarded\n        G={G}\n        ctx={ctx}\n        onPickSuit={setPickedSuit}\n        pickedSuit={pickedSuit}\n        disabled={!isActive || stage !== 'drawCard'}\n      />\n      <Played\n        cards={G.played[playerID]}\n        scores={G.scores[playerID]}\n        caption=\"Your cards\"\n      />\n      <Hand\n        cards={G.players[playerID].hand}\n        onPickCard={setPickedCard}\n        pickedCard={pickedCard}\n        disabled={!isActive || stage !== 'playCard'}\n      />\n      <Actions\n        G={G}\n        ctx={ctx}\n        moves={moves}\n        card={pickedCard}\n        suit={pickedSuit}\n        stage={stage}\n        active={isActive}\n      />\n    </>\n  );\n}\n"],"sourceRoot":""}